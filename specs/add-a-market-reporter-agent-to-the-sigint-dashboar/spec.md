# Feature Specification: Market Reporter Agent for SIGINT Dashboard

**Generated**: 2026-01-08T22:58:17.092999
**Status**: Draft
**Source**: Auto-generated by Smactorio workflow

---

## Overview

Add a Market Reporter agent to the SIGINT dashboard that fetches cryptocurrency price data from CoinGecko API and uses an LLM to intelligently curate and highlight notable market movements. The feature displays financial data as a compact, horizontally scrolling ticker strip, automatically refreshing every 5 minutes.

## Problem Statement

SIGINT dashboard users currently lack visibility into cryptocurrency market movements. Users need a quick, at-a-glance view of market data with intelligent highlighting of significant price movements (>5% changes) to stay informed about notable market activity without manually checking multiple sources.

---

## User Stories

### US1 - View Cryptocurrency Prices in Ticker Strip (Priority: P0)

As a **Dashboard User**, I want to **view real-time cryptocurrency prices (BTC, ETH, SOL, DOGE, XRP) in a horizontally scrolling ticker strip**, so that **I can quickly monitor market prices at a glance without leaving the dashboard**.

**Independent Test**: Load the SIGINT dashboard and verify the ticker strip is visible, scrolling horizontally, and displays prices for all 5 cryptocurrencies with valid numeric values.

**Acceptance Criteria**:

1. Ticker strip displays current prices for BTC, ETH, SOL, DOGE, and XRP
2. Prices are fetched from CoinGecko API
3. Ticker scrolls horizontally in a continuous loop
4. Display format is compact and readable
5. Ticker strip is visually distinct from card-based content

### US2 - Highlight Notable Price Movements (Priority: P0)

As a **Dashboard User**, I want to **see notable price movements (>5% changes) prominently highlighted in the ticker**, so that **I can immediately identify significant market activity without analyzing all prices manually**.

**Independent Test**: Mock CoinGecko response with one coin showing >5% change and verify the LLM selects it for highlighting and it appears visually distinct in the ticker.

**Acceptance Criteria**:

1. LLM analyzes price data to identify movements >5% (up or down)
2. Notable movers are visually distinguished in the ticker strip
3. Both big risers and big fallers are identified and highlighted
4. Highlighting is clear and attention-grabbing

### US3 - Automatic Market Data Refresh (Priority: P1)

As a **Dashboard User**, I want to **have market data automatically refresh every 5 minutes**, so that **I always see current market information without manual refresh**.

**Independent Test**: Deploy the EventBridge rule and verify CloudWatch logs show the market reporter Lambda executing every 5 minutes with fresh CoinGecko data.

**Acceptance Criteria**:

1. EventBridge rule triggers market reporter every 5 minutes
2. Ticker strip updates with fresh data after each trigger
3. No user intervention required for updates
4. Update frequency is exactly 5 minutes

### US4 - Filter Dashboard by Markets Category (Priority: P1)

As a **Dashboard User**, I want to **filter the dashboard to show only market-related content using a MARKETS category**, so that **I can focus specifically on financial market information when needed**.

**Independent Test**: Select the MARKETS category filter on the dashboard and verify only market ticker content is displayed, then deselect and verify market content is hidden.

**Acceptance Criteria**:

1. MARKETS category is added to the Category enum
2. Market reporter items are tagged with MARKETS category
3. Category filter correctly shows/hides market content
4. MARKETS category appears in category selection UI

### US5 - Market Reporter Lambda Implementation (Priority: P0)

As a **Developer**, I want to **implement the market reporter following the existing reporter pattern in lambdas/reporters/handler.py**, so that **the codebase remains consistent and maintainable with established patterns**.

**Independent Test**: Review the market reporter code and verify it follows the same class/function structure, error handling, and logging patterns as existing reporters in the handler.py file.

**Acceptance Criteria**:

1. Market reporter follows the same structure as existing reporters
2. Reporter is located in lambdas/reporters/ directory
3. Handler function signature matches existing pattern
4. Error handling follows existing conventions
5. Logging follows existing patterns

### US6 - Market-Focused LLM Prompt (Priority: P1)

As a **Developer**, I want to **add a market-focused prompt in llm_client.py for selecting notable movers**, so that **the LLM can intelligently analyze and select the most interesting market movements**.

**Independent Test**: Call the LLM client with sample market data containing mixed price movements and verify the response correctly identifies coins with >5% changes.

**Acceptance Criteria**:

1. New prompt template added to llm_client.py
2. Prompt instructs LLM to identify >5% price movements
3. Prompt guides LLM to select both risers and fallers
4. Prompt produces consistent, parseable output format

### US7 - CoinGecko API Integration (Priority: P0)

As a **Developer**, I want to **integrate with CoinGecko API to fetch cryptocurrency prices without requiring new API keys**, so that **the system can retrieve market data using CoinGecko's free public API**.

**Independent Test**: Execute the CoinGecko API client in isolation and verify it returns valid price data for all 5 cryptocurrencies without any API key configuration.

**Acceptance Criteria**:

1. Uses CoinGecko public API endpoint
2. No API key configuration required
3. Fetches prices for BTC, ETH, SOL, DOGE, XRP
4. Handles API rate limits gracefully
5. Includes proper error handling for API failures

---

## Entities

### MarketData
**Type**: entity
**Description**: Cryptocurrency price data fetched from CoinGecko
**Attributes**:
  - symbol
  - price_usd
  - price_change_24h_percent
  - last_updated

### Category
**Type**: entity
**Description**: Extended enum including new MARKETS category
**Attributes**:
  - MARKETS

### NotableMover
**Type**: entity
**Description**: Cryptocurrency identified by LLM as having significant movement
**Attributes**:
  - symbol
  - direction
  - change_percent
  - highlight_reason

## Functional Requirements

FR-001: FR-001: System shall fetch cryptocurrency prices for BTC, ETH, SOL, DOGE, XRP from CoinGecko API
FR-002: FR-002: System shall add MARKETS to the Category enum
FR-003: FR-003: System shall display market data in a horizontally scrolling ticker strip format
FR-004: FR-004: System shall use LLM to identify and select notable price movements (>5% change)
FR-005: FR-005: System shall visually highlight notable movers in the ticker display
FR-006: FR-006: System shall update market data every 5 minutes via EventBridge
FR-007: FR-007: System shall implement market reporter following existing pattern in lambdas/reporters/handler.py
FR-008: FR-008: System shall include market-focused prompt in llm_client.py for mover selection

## Non-Functional Requirements

NFR-001: NFR-001: Market data shall refresh every 5 minutes (300 seconds)
NFR-002: NFR-002: CoinGecko API integration shall not require additional API keys
NFR-003: NFR-003: Ticker strip shall scroll smoothly without visual stuttering
NFR-004: NFR-004: System shall handle CoinGecko API failures gracefully without crashing
NFR-005: NFR-005: Market reporter shall follow existing code patterns for maintainability

## Business Rules

- BR-001: Notable movers are defined as cryptocurrencies with >5% price change (up or down)
- BR-002: Raw price display does not require LLM processing
- BR-003: Only LLM-selected notable movers shall be prominently featured
- BR-004: Supported cryptocurrencies are limited to BTC, ETH, SOL, DOGE, XRP

## Assumptions

- CoinGecko public API provides sufficient rate limits for 5-minute polling
- Existing EventBridge infrastructure can accommodate new 5-minute schedule
- Frontend framework supports horizontal scrolling ticker implementation
- LLM service is available and has capacity for additional market analysis requests
- 24-hour price change percentage is available from CoinGecko API

## Open Questions

- [ ] Should the ticker display 24h change or a different time window?
- [ ] What should happen if CoinGecko API is unavailable - show stale data or hide ticker?
- [ ] Should there be a maximum number of notable movers highlighted at once?
- [ ] What color scheme should be used for up vs down movements in the ticker?

## Success Criteria

- Market ticker strip displays current prices for all 5 cryptocurrencies
- Notable movers (>5% change) are visually highlighted in the ticker
- Data refreshes automatically every 5 minutes without user intervention
- MARKETS category filter correctly shows/hides market content
- Market reporter Lambda executes successfully on EventBridge schedule
- No new API keys or credentials are required for deployment
- Code follows existing reporter patterns and passes code review
