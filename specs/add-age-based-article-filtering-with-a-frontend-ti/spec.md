# Feature Specification: Age-Based Article Filtering with Time Range Slider

**Generated**: 2026-01-09T12:40:45.262688
**Status**: Draft
**Source**: Auto-generated by Smactorio workflow

---

## Overview

This feature adds a configurable time range slider to the frontend that allows users to filter articles by age, from 24 hours up to 30 days. The filtering occurs before LLM processing to reduce API costs, with backend support for fetching archived articles across multiple days.

## Problem Statement

Currently, users cannot control the age of articles displayed in their feed, and all articles are processed through expensive LLM calls regardless of relevance. This leads to unnecessary API costs and a lack of user control over content freshness. Users need the ability to view both recent articles and historical content from archives while optimizing system costs.

---

## User Stories

### US1 - Filter Articles by Age Before LLM Processing (Priority: P0)

As a **system administrator**, I want to **have articles filtered by age before they are sent to LLM processing**, so that **I can reduce LLM API costs by only processing articles within the desired time range**.

**Independent Test**: Configure age filter to 1 hour, add articles with timestamps from 30 minutes ago and 2 hours ago, verify only the 30-minute article is sent to LLM processing

**Acceptance Criteria**:

1. Articles older than the configured age threshold are excluded before LLM calls in feed_fetcher.py
2. Default age filter is 24 hours when no user preference is set
3. Maximum configurable age is 30 days
4. LLM processing only receives articles that pass the age filter

### US2 - Time Range Slider Control (Priority: P0)

As a **end user**, I want to **use a slider in the frontend to select how far back in time I want to see articles**, so that **I can control the freshness of my news feed and access historical content when needed**.

**Independent Test**: Load the frontend, verify slider is present, move slider to 7 days, confirm displayed value updates to show '7 days'

**Acceptance Criteria**:

1. Slider is visible in index.html with proper styling from style.css
2. Slider range is from 24 hours (minimum) to 30 days (maximum)
3. Slider value is displayed to the user in a human-readable format
4. Slider interaction is handled by app.js
5. Default slider position is 24 hours

### US3 - Archive Range Retrieval (Priority: P0)

As a **developer**, I want to **call a get_archive_range() method in s3_store.py to fetch articles from multiple days**, so that **I can retrieve historical articles from S3 archives to support the time range filtering feature**.

**Independent Test**: Call get_archive_range() with a 3-day range where day 2 has no archive, verify articles from days 1 and 3 are returned without errors

**Acceptance Criteria**:

1. get_archive_range() method exists in s3_store.py
2. Method accepts start_date and end_date parameters
3. Method returns articles from all archive files within the specified date range
4. Method handles missing archive files gracefully without errors

### US4 - Merge Archive with Current Data (Priority: P1)

As a **end user**, I want to **see archived articles merged with current articles when I adjust the time slider**, so that **I get a seamless view of both recent and historical content in a single feed**.

**Independent Test**: Set slider to 7 days, verify that current articles and archived articles from the past week appear together, sorted by date, with no duplicate entries

**Acceptance Criteria**:

1. When slider is moved beyond current data, archived articles are fetched
2. Archived articles are merged with current articles without duplicates
3. Merged results are sorted by date (newest first)
4. UI updates to reflect the merged content

### US5 - Configurable Default Age Setting (Priority: P1)

As a **system administrator**, I want to **configure the default age filter in config/feeds.json global_settings**, so that **I can set an organization-wide default for article freshness without requiring code changes**.

**Independent Test**: Set default_age_hours to 48 in config, start application without user preference, verify articles up to 48 hours old are displayed by default

**Acceptance Criteria**:

1. default_age_hours setting exists in config/feeds.json under global_settings
2. System uses this value when no user preference is specified
3. Valid range is 24 to 720 hours (30 days)
4. Invalid values fall back to 24 hours with a warning log

### US6 - Slider Styling and UX (Priority: P2)

As a **end user**, I want to **interact with a visually appealing and responsive time range slider**, so that **I have a pleasant user experience when adjusting article age preferences**.

**Independent Test**: Open frontend on mobile viewport (375px width), verify slider is usable and labels are readable

**Acceptance Criteria**:

1. Slider has consistent styling defined in style.css
2. Slider is responsive and works on mobile devices
3. Slider shows tick marks or labels for common intervals (1 day, 7 days, 30 days)
4. Slider value updates in real-time as user drags

---

## Entities

### ArticleFilter
**Type**: entity
**Description**: Represents the age-based filtering configuration
**Attributes**:
  - age_hours
  - start_date
  - end_date

### ArchiveRange
**Type**: entity
**Description**: Represents a date range for archive retrieval
**Attributes**:
  - start_date
  - end_date
  - articles

## Functional Requirements

FR-001: FR-001: The system shall filter articles by age before sending them to LLM processing in feed_fetcher.py
FR-002: FR-002: The system shall provide a get_archive_range(start_date, end_date) method in s3_store.py
FR-003: FR-003: The frontend shall display a time range slider in index.html
FR-004: FR-004: The slider shall have a minimum value of 24 hours and maximum value of 30 days (720 hours)
FR-005: FR-005: The app.js shall handle slider interactions and trigger data fetching
FR-006: FR-006: The system shall merge archived articles with current articles without duplicates
FR-007: FR-007: The config/feeds.json shall support a default_age_hours setting in global_settings

## Non-Functional Requirements

NFR-001: NFR-001: Archive retrieval for 30 days should complete within 5 seconds
NFR-002: NFR-002: Slider interaction should feel responsive with updates under 100ms
NFR-003: NFR-003: The feature should reduce LLM API costs proportionally to the age filter reduction
NFR-004: NFR-004: Frontend slider should be accessible and keyboard-navigable

## Business Rules

- BR-001: Default article age is 24 hours unless configured otherwise
- BR-002: Maximum article age cannot exceed 30 days
- BR-003: Articles must be filtered BEFORE LLM processing to achieve cost savings
- BR-004: When merging articles, duplicates are identified by article URL or unique ID

## Assumptions

- S3 archives are organized by date and accessible via the existing s3_store.py infrastructure
- Article timestamps are stored in a consistent, parseable format
- The frontend has existing infrastructure for making API calls via app.js
- LLM costs are proportional to the number of articles processed

## Open Questions

- [ ] Should the slider use a linear or logarithmic scale for better UX?
- [ ] How should the system handle timezone differences in article timestamps?
- [ ] Should there be a loading indicator while fetching archived articles?
- [ ] What happens if archived articles have been modified since archival?

## Success Criteria

- Users can adjust the time range slider and see articles filtered accordingly
- LLM API costs decrease when users select shorter time ranges
- Archive retrieval successfully returns articles from multiple days
- Default age setting in config/feeds.json is respected by the system
- No duplicate articles appear when merging current and archived content
- Frontend slider is functional and styled consistently with the application
