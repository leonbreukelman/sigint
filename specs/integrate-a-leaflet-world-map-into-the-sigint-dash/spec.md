# Feature Specification: SIGINT Dashboard Leaflet World Map Integration

**Generated**: 2026-01-09T10:01:45.494054
**Status**: Draft
**Source**: Auto-generated by Smactorio workflow

---

## Overview

Integrate an interactive Leaflet world map into the SIGINT dashboard frontend to visualize news item locations geographically. The map uses CartoDB Dark tiles to match the terminal aesthetic, automatically extracts locations from news content, displays category-colored pulsing markers, and provides an intuitive collapsible interface for users to explore global intelligence data spatially.

## Problem Statement

Currently, the SIGINT dashboard displays news items in a list format without geographic context. Users cannot quickly identify geographic patterns or clusters of activity across different intelligence categories. A visual map representation would enable analysts to spot regional trends, understand the geographic distribution of events, and quickly assess global hotspots at a glance.

---

## User Stories

### US1 - View News Locations on World Map (Priority: P0)

As a **intelligence analyst**, I want to **see news items plotted on an interactive world map**, so that **I can quickly identify geographic patterns and regional clusters of intelligence activity**.

**Independent Test**: Load the SIGINT dashboard and verify the Leaflet map renders with CartoDB Dark tiles within 3 seconds of page load

**Acceptance Criteria**:

1. Map displays using CartoDB Dark tiles matching the terminal aesthetic
2. Map renders correctly in the dashboard layout
3. Map is responsive and works on different screen sizes
4. Map loads without blocking other dashboard functionality

### US2 - Automatic Location Extraction (Priority: P0)

As a **intelligence analyst**, I want to **have locations automatically extracted from news titles and summaries**, so that **I don't have to manually tag or search for geographic references in articles**.

**Independent Test**: Submit 10 news items with known location references in titles/summaries and verify at least 80% are correctly extracted and plotted

**Acceptance Criteria**:

1. Location database contains 100+ countries and major cities
2. System scans news titles and summaries for location matches
3. Extracted locations are mapped to valid coordinates
4. Unrecognized locations are gracefully handled without errors

### US3 - Category-Colored Markers (Priority: P0)

As a **intelligence analyst**, I want to **see markers colored by intelligence category with pulsing animation**, so that **I can instantly distinguish between different types of intelligence at a glance**.

**Independent Test**: Load news items from all four categories and verify each marker displays the correct color with visible pulsing animation

**Acceptance Criteria**:

1. Geopolitical markers display in Red
2. AI/ML markers display in Green
3. Deep Tech markers display in Blue
4. Crypto/Finance markers display in Orange
5. All markers have visible pulsing animation
6. Marker colors are consistent with dashboard category colors

### US4 - Interactive Marker Popups (Priority: P1)

As a **intelligence analyst**, I want to **click on a marker to see article details in a popup**, so that **I can quickly preview article information without leaving the map view**.

**Independent Test**: Click on 5 different markers and verify each popup displays all required fields (title, category, location, read more link) correctly

**Acceptance Criteria**:

1. Clicking a marker opens a popup overlay
2. Popup displays article title
3. Popup displays article category
4. Popup displays extracted location name
5. Popup contains a 'Read More' link to the full article
6. Popup closes when clicking elsewhere on the map

### US5 - Collapsible Map Toggle (Priority: P1)

As a **intelligence analyst**, I want to **collapse and expand the map using a toggle button**, so that **I can maximize screen space for the news feed when geographic context isn't needed**.

**Independent Test**: Toggle the map collapsed and expanded 3 times and verify the map renders correctly each time with smooth transitions

**Acceptance Criteria**:

1. Toggle button is clearly visible in the map section
2. Clicking toggle collapses map to minimal height
3. Clicking toggle again expands map to full height
4. Map state persists correctly during toggle
5. Toggle animation is smooth and not jarring

### US6 - Dynamic Marker Updates (Priority: P0)

As a **intelligence analyst**, I want to **see map markers update automatically when new category data loads**, so that **I always see the most current geographic distribution without manual refresh**.

**Independent Test**: Trigger a category data reload and verify markers update within 2 seconds without duplicates or missing items

**Acceptance Criteria**:

1. Markers update when category data loads from API
2. New markers appear without page refresh
3. Removed items have their markers cleared
4. Map performance remains smooth during updates
5. No duplicate markers appear for the same location

### US7 - File Structure Setup (Priority: P0)

As a **developer**, I want to **have map.js and map.css properly located in the frontend directory**, so that **the codebase follows consistent structure and the map module loads correctly**.

**Independent Test**: Verify all file paths resolve correctly and no 404 errors occur when loading the dashboard

**Acceptance Criteria**:

1. map.js is moved from specs/ to frontend/
2. map.css is moved from specs/ to frontend/
3. index.html includes Leaflet CDN links (CSS and JS)
4. index.html contains map section HTML structure
5. app.js initializes SigintMap on page load
6. app.js calls updateMarkers() when category data loads

---

## Entities

### LocationDatabase
**Type**: entity
**Description**: Database of 100+ countries and cities with coordinates
**Attributes**:
  - name
  - aliases
  - latitude
  - longitude
  - type

### MapMarker
**Type**: entity
**Description**: Visual marker on the map representing a news item
**Attributes**:
  - coordinates
  - category
  - color
  - newsItem
  - popup

### SigintMap
**Type**: entity
**Description**: Main map controller class
**Attributes**:
  - leafletInstance
  - markers
  - isCollapsed
  - tileLayer

## Functional Requirements

FR-001: FR-001: System shall render a Leaflet map using CartoDB Dark tile layer
FR-002: FR-002: System shall maintain a location database of 100+ countries and major cities
FR-003: FR-003: System shall extract location references from news item titles and summaries
FR-004: FR-004: System shall display pulsing markers colored by category (Red=Geopolitical, Green=AI/ML, Blue=Deep Tech, Orange=Crypto/Finance)
FR-005: FR-005: System shall display popup on marker click with title, category, location, and read more link
FR-006: FR-006: System shall provide toggle button to collapse/expand map section
FR-007: FR-007: System shall update markers when category data loads via updateMarkers() method
FR-008: FR-008: System shall initialize SigintMap class from app.js on page load

## Non-Functional Requirements

NFR-001: NFR-001: Map shall load within 3 seconds on standard broadband connection
NFR-002: NFR-002: Map shall maintain 60fps during pan/zoom operations
NFR-003: NFR-003: Map styling shall match existing terminal/dark aesthetic of dashboard
NFR-004: NFR-004: Map shall be responsive across desktop screen sizes (1024px+)
NFR-005: NFR-005: Marker updates shall complete within 2 seconds of data load

## Business Rules

- BR-001: Each news item can have at most one primary location marker
- BR-002: If multiple locations are detected, use the first mentioned location
- BR-003: News items without detectable locations shall not display markers
- BR-004: Category colors must match the existing dashboard color scheme

## Assumptions

- Leaflet and CartoDB tile services are available and reliable
- The existing map.js and map.css files in specs/ are complete and functional
- News items contain location references in English
- The dashboard already has a category-based data loading mechanism in app.js
- Users have modern browsers supporting ES6+ JavaScript

## Open Questions

- [ ] Should markers cluster when zoomed out to prevent visual clutter?
- [ ] What should happen when multiple news items reference the same location?
- [ ] Should the map remember its last position/zoom level between sessions?
- [ ] Are there any rate limits on the CartoDB tile service to consider?
- [ ] Should location extraction support non-English location names?

## Success Criteria

- Map renders with CartoDB Dark tiles matching dashboard aesthetic
- At least 80% of news items with location references are correctly plotted
- All four category colors display correctly with pulsing animation
- Marker popups display all required information (title, category, location, link)
- Map toggle collapses and expands smoothly
- Markers update automatically when category data loads
- No console errors during normal map operation
- Map files are correctly located in frontend/ directory
- Leaflet CDN resources load without errors
